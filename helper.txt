this is additional code I wrote to try to fix this problem.
